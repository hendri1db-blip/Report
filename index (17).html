<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Report Builder v3.1</title>
<style>
  :root{
    --blue:#004080;
    --blue-dark:#003060;
    --bg:#f5f6f8;
    --card:#ffffff;
    --border:#d9d9df;
    --text:#1d1d1f;
    --muted:#666;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;color:var(--text);background:var(--bg)}
  header{background:var(--blue);color:#fff;padding:16px 20px;display:flex;align-items:center;justify-content:space-between}
  header h1{margin:0;font-size:20px;font-weight:600;letter-spacing:.3px}
  header .actions{display:flex;gap:10px}
  .btn{background:var(--blue);color:#fff;border:none;padding:10px 14px;font-size:14px;border-radius:8px;cursor:pointer}
  .btn.small{padding:6px 10px;font-size:12px;border-radius:6px}
  .btn.secondary{background:#e9ecf4;color:#222;border:1px solid var(--border)}
  .btn.destructive{background:#ffe9e9;color:#8b1a1a;border:1px solid #f2c2c2}
  .btn:hover{background:var(--blue-dark)}
  .btn.secondary:hover{background:#dde3f3}
  .btn.destructive:hover{background:#ffdede}
  main{padding:20px;max-width:1100px;margin:0 auto}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px;box-shadow:0 1px 2px rgba(0,0,0,.04)}
  .grid{display:grid;gap:14px}
  .grid.cols-2{grid-template-columns:1fr 1fr}
  .grid.cols-3{grid-template-columns:repeat(3,1fr)}
  .field label{display:block;font-size:13px;margin-bottom:6px;color:#444}
  .field input,.field textarea,.field select{width:100%;padding:10px;border:1px solid var(--border);border-radius:8px;background:#fff;font-size:14px}
  textarea{min-height:140px;resize:vertical}
  h2.sectionTitle{margin:22px 0 12px 0;font-size:18px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid var(--border);text-align:left;font-size:14px}
  th{background:#f0f3fa}
  tr:hover td{background:#fafbff}
  .muted{color:var(--muted);font-size:13px}
  .toolbar{display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;border:1px solid var(--border);background:#f4f6ff;font-size:12px}
  .right{margin-left:auto}
  .two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .photos-uploader{border:1px dashed var(--border);border-radius:10px;padding:14px;text-align:center;background:#fff}
  .photos-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;margin-top:12px}
  .photo-item{position:relative;border:1px solid var(--border);border-radius:8px;overflow:hidden;background:#fff}
  .photo-item img{display:block;width:100%;height:140px;object-fit:cover}
  .photo-caption{border-top:1px solid var(--border);padding:8px;font-size:12px}
  .photo-del{position:absolute;top:6px;right:6px;background:rgba(0,0,0,.55);color:#fff;border:none;border-radius:6px;padding:4px 6px;cursor:pointer;font-size:12px}
  .transcribe-tools{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
  .clips{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
  .clip{border:1px solid var(--border);border-radius:10px;padding:10px;background:#fff}
  .clip input{width:100%;margin-top:6px}
  .tag{display:inline-block;background:#eef3ff;border:1px solid #cfd8ff;border-radius:999px;padding:4px 8px;font-size:12px;color:#2a3d7a}
  .autosave{display:flex;gap:8px;align-items:center}
  .autosave .dot{width:8px;height:8px;border-radius:50%;background:#bbb}
  .autosave.saving .dot{background:#f6c12a}
  .autosave.saved .dot{background:#36b37e}
  /* Fees */
  .fee-table input{width:100%;border:none;outline:none;background:transparent}
  .fee-table td {vertical-align:middle}
  .fee-table .num{text-align:right}
  .fee-summary{display:grid;gap:6px;max-width:320px;margin-left:auto}
  .fee-summary div{display:flex;justify-content:space-between}
  /* Print styles */
  @media print{
    header, .no-print{display:none !important}
    main{max-width:none}
    body{background:#fff}
    .card{border:none;box-shadow:none;padding:0}
    .page-break{page-break-before:always}
    .photos-grid{grid-template-columns:repeat(2,1fr)}
    .photo-item img{height:260px}
    .transcribe-tools,.clips .controls{display:none !important}
    .fee-table input{border:none}
  }
</style>
</head>
<body>
<header>
  <h1>Report Builder v3.1</h1>
  <div class="actions">
    <div class="autosave no-print" id="autosaveBadge" title="Autosave status"><span class="dot"></span><span id="autosaveText" class="muted">Idle</span></div>
    <button class="btn secondary no-print" id="btnGoDashboard" style="display:none">All Claims</button>
    <button class="btn no-print" id="btnPrint" style="display:none">Export PDF</button>
  </div>
</header>

<main>
  <!-- Dashboard View -->
  <div id="dashboard" class="card">
    <div class="toolbar">
      <button class="btn" id="btnNew">New Report</button>
      <button class="btn secondary" id="btnRefresh">Refresh</button>
      <span class="pill">Local drafts are saved in this browser</span>
    </div>
    <table>
      <thead><tr><th>Claim Ref / Title</th><th>Insured</th><th>Updated</th><th class="no-print">Actions</th></tr></thead>
      <tbody id="claimsTbody"></tbody>
    </table>
    <p class="muted" id="noClaimsMsg" style="display:none">No claims saved yet. Click <b>New Report</b> to create your first one.</p>
  </div>

  <!-- Editor View -->
  <div id="editor" style="display:none">
    <div class="card">
      <!-- Postal / Info block -->
      <div class="grid cols-3">
        <div class="field"><label>Claim Ref / Title</label><input id="claimRef" placeholder="e.g., HL-2025-0912 / Roof leak ‚Äì 15 Rose St" /></div>
        <div class="field"><label>Insured</label><input id="insured" placeholder="Mr/Mrs Name or Business" /></div>
        <div class="field"><label>Assessor</label><input id="assessor" placeholder="Your name" /></div>
        <div class="field"><label>Policy Number</label><input id="policyNo" /></div>
        <div class="field"><label>Insurer</label><input id="insurer" /></div>
        <div class="field"><label>Broker / Admin Agent</label><input id="broker" /></div>
        <div class="field"><label>Risk Address</label><input id="riskAddress" placeholder="Street, Suburb, City" /></div>
        <div class="field"><label>Date of Loss</label><input id="dateOfLoss" type="date" /></div>
        <div class="field"><label>Date of Assessment</label><input id="dateOfAssessment" type="date" /></div>
        <div class="field"><label>Contact Number</label><input id="contactNumber" /></div>
        <div class="field"><label>Email</label><input id="email" type="email" /></div>
        <div class="field"><label>Postal / Notes</label><input id="postalBlock" placeholder="Postal address / internal notes" /></div>
      </div>

      <h2 class="sectionTitle">Circumstances of Loss</h2>
      <div class="field"><textarea id="circumstances" placeholder="Enter circumstances of loss..."></textarea></div>

      <h2 class="sectionTitle">Assessment</h2>
      <div class="field"><textarea id="assessment" placeholder="Enter assessment details..."></textarea></div>

      <h2 class="sectionTitle">Conclusion</h2>
      <div class="field"><textarea id="conclusion" placeholder="Enter conclusion..."></textarea></div>

      <h2 class="sectionTitle">Photos</h2>
      <div class="photos-uploader no-print">
        <input type="file" id="photoInput" accept="image/*" multiple capture="environment" />
        <p class="muted">Select or capture multiple photos. Images are stored locally in your browser (no upload).</p>
      </div>
      <div id="photosGrid" class="photos-grid"></div>

      <h2 class="sectionTitle page-break">Transcript / Voice Notes</h2>
      <div class="transcribe-tools no-print">
        <button class="btn small" id="btnStartRec">üéôÔ∏è Start Recording</button>
        <button class="btn small secondary" id="btnStopRec" disabled>Stop</button>
        <button class="btn small secondary" id="btnToggleSTT">Enable Live Transcribe</button>
        <label class="btn small secondary">
          Import .txt
          <input type="file" id="txtImport" accept=".txt" style="display:none" />
        </label>
        <span id="recStatus" class="tag" style="display:none">Recording‚Ä¶</span>
        <span id="sttStatus" class="tag" style="display:none">Live Transcribe ON</span>
      </div>
      <div class="field">
        <textarea id="transcript" style="min-height:480px" placeholder="Type notes here. Live Transcribe (Chrome) appends speech automatically."></textarea>
      </div>
      <div class="clips" id="clips"></div>

      <h2 class="sectionTitle">Note of Fee</h2>
      <div class="field">
        <table class="fee-table" id="feeTable">
          <thead><tr><th>Description</th><th style="width:100px">Qty</th><th style="width:140px">Rate</th><th style="width:140px">Amount</th><th class="no-print" style="width:80px">Action</th></tr></thead>
          <tbody id="feeBody"></tbody>
        </table>
        <div class="toolbar no-print" style="margin-top:8px">
          <button class="btn small" id="addFeeRow">Add Row</button>
          <button class="btn small secondary" id="clearFees">Clear</button>
        </div>
        <div class="fee-summary">
          <div><span>Subtotal</span><strong id="feeSubtotal">0.00</strong></div>
          <div><span>VAT (15%)</span><strong id="feeVAT">0.00</strong></div>
          <div><span>Total</span><strong id="feeTotal">0.00</strong></div>
        </div>
      </div>

      <div class="toolbar no-print" style="margin-top:12px">
        <button class="btn" id="btnSave">Save</button>
        <button class="btn secondary" id="btnSaveExit">Save & Back</button>
        <button class="btn destructive" id="btnDelete">Delete</button>
      </div>
    </div>
  </div>
</main>

<script>
// ---------- Storage helpers ----------
const IDX_KEY='claimsIndex_v31';
function loadIndex(){try{return JSON.parse(localStorage.getItem(IDX_KEY))||[]}catch{return[]}}
function saveIndex(i){localStorage.setItem(IDX_KEY,JSON.stringify(i));}
function claimKey(id){return 'claim_v31:'+id}
function loadClaim(id){try{return JSON.parse(localStorage.getItem(claimKey(id)))||null}catch{return null}}
function saveClaim(id,d){localStorage.setItem(claimKey(id),JSON.stringify(d));}
function deleteClaim(id){localStorage.removeItem(claimKey(id));saveIndex(loadIndex().filter(x=>x.id!==id));}

// ---------- Elements ----------
const $dashboard=document.getElementById('dashboard'),$editor=document.getElementById('editor'),$claimsTbody=document.getElementById('claimsTbody'),$noClaimsMsg=document.getElementById('noClaimsMsg');
const $btnNew=document.getElementById('btnNew'),$btnRefresh=document.getElementById('btnRefresh'),$btnGoDashboard=document.getElementById('btnGoDashboard'),$btnPrint=document.getElementById('btnPrint');
const $autosaveBadge=document.getElementById('autosaveBadge'),$autosaveText=document.getElementById('autosaveText');
let currentId=null,currentPhotos=[],clips=[],feeRows=[];

// ---------- Dashboard ----------
function escapeHtml(s){return (s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',\"'\":'&#39;'}[m]));}
function renderDashboard(){const idx=loadIndex().sort((a,b)=>b.updated-a.updated);$claimsTbody.innerHTML='';$noClaimsMsg.style.display=idx.length?'none':'block';for(const it of idx){const tr=document.createElement('tr');tr.innerHTML=`<td>${escapeHtml(it.title||'(Untitled)')}</td><td>${escapeHtml(it.insured||'')}</td><td>${new Date(it.updated).toLocaleString()}</td><td class='no-print'><button class='btn small' data-open='${it.id}'>Open</button> <button class='btn small secondary' data-del='${it.id}'>Delete</button></td>`;$claimsTbody.appendChild(tr);}}
function switchToDashboard(){$editor.style.display='none';$dashboard.style.display='block';$btnPrint.style.display='none';$btnGoDashboard.style.display='none';renderDashboard();}
function switchToEditor(){$dashboard.style.display='none';$editor.style.display='block';$btnPrint.style.display='inline-block';$btnGoDashboard.style.display='inline-block';}

// ---------- Form fields ----------
const $claimRef=document.getElementById('claimRef'),$insured=document.getElementById('insured'),$assessor=document.getElementById('assessor'),$policyNo=document.getElementById('policyNo'),$insurer=document.getElementById('insurer'),$broker=document.getElementById('broker'),$riskAddress=document.getElementById('riskAddress'),$dateOfLoss=document.getElementById('dateOfLoss'),$dateOfAssessment=document.getElementById('dateOfAssessment'),$contactNumber=document.getElementById('contactNumber'),$email=document.getElementById('email'),$postalBlock=document.getElementById('postalBlock'),$circumstances=document.getElementById('circumstances'),$assessment=document.getElementById('assessment'),$conclusion=document.getElementById('conclusion'),$transcript=document.getElementById('transcript');
const $photoInput=document.getElementById('photoInput'),$photosGrid=document.getElementById('photosGrid');
const $btnSave=document.getElementById('btnSave'),$btnSaveExit=document.getElementById('btnSaveExit'),$btnDelete=document.getElementById('btnDelete');

// ---------- Photos ----------
function renderPhotos(){$photosGrid.innerHTML='';currentPhotos.forEach((p,i)=>{const d=document.createElement('div');d.className='photo-item';d.innerHTML=`<button class='photo-del' data-delp='${i}'>‚úï</button><img src='${p.dataUrl}'/><div class='photo-caption'><input data-cap='${i}' value='${escapeHtml(p.caption||'')}' placeholder='Caption (optional)' style='width:100%;border:none;outline:none'></div>`;$photosGrid.appendChild(d);});}
$photoInput.addEventListener('change',async e=>{for(const f of Array.from(e.target.files||[])){const dataUrl=await fileToDataURL(f);currentPhotos.push({dataUrl,caption:''});}renderPhotos();e.target.value='';});
$photosGrid.addEventListener('input',e=>{const i=e.target.getAttribute('data-cap');if(i!=null){currentPhotos[+i].caption=e.target.value;}});
$photosGrid.addEventListener('click',e=>{const i=e.target.getAttribute('data-delp');if(i!=null){currentPhotos.splice(+i,1);renderPhotos();}});
function fileToDataURL(f){return new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result);r.onerror=rej;r.readAsDataURL(f);});}

// ---------- Transcript / Voice ----------
const $clips=document.getElementById('clips'),$btnStartRec=document.getElementById('btnStartRec'),$btnStopRec=document.getElementById('btnStopRec'),$btnToggleSTT=document.getElementById('btnToggleSTT'),$recStatus=document.getElementById('recStatus'),$sttStatus=document.getElementById('sttStatus'),$txtImport=document.getElementById('txtImport');
let mediaRecorder=null,recChunks=[],startTime=null,stt=null,sttOn=false;
function renderClips(){$clips.innerHTML='';clips.forEach((c,i)=>{const el=document.createElement('div');el.className='clip';el.innerHTML=`<audio controls src='${c.dataUrl}' style='width:100%'></audio><div class='controls' style='display:flex;gap:8px;margin-top:8px'><input data-capclip='${i}' value='${escapeHtml(c.caption||'')}' placeholder='Caption (optional)'><button class='btn small secondary' data-delclip='${i}'>Delete</button></div><div class='muted'>Duration: ${Math.round(c.duration||0)}s</div>`;$clips.appendChild(el);});}
$clips.addEventListener('input',e=>{const i=e.target.getAttribute('data-capclip');if(i!=null){clips[+i].caption=e.target.value;}});
$clips.addEventListener('click',e=>{const i=e.target.getAttribute('data-delclip');if(i!=null){clips.splice(+i,1);renderClips();}});
$btnStartRec.addEventListener('click',async()=>{try{const stream=await navigator.mediaDevices.getUserMedia({audio:true});recChunks=[];mediaRecorder=new MediaRecorder(stream);mediaRecorder.ondataavailable=e=>{if(e.data.size>0)recChunks.push(e.data)};mediaRecorder.onstop=async()=>{const blob=new Blob(recChunks,{type:'audio/webm'});const dataUrl=await blobToDataURL(blob);const duration=(Date.now()-startTime)/1000;clips.push({dataUrl,caption:'',duration});renderClips();stream.getTracks().forEach(t=>t.stop());};mediaRecorder.start();startTime=Date.now();$recStatus.style.display='inline-block';$btnStartRec.disabled=true;$btnStopRec.disabled=false;}catch(err){alert('Microphone access denied or not available.');}});
$btnStopRec.addEventListener('click',()=>{if(mediaRecorder&&mediaRecorder.state!=='inactive'){mediaRecorder.stop();}$recStatus.style.display='none';$btnStartRec.disabled=false;$btnStopRec.disabled=true;});
function blobToDataURL(b){return new Promise(r=>{const fr=new FileReader();fr.onload=()=>r(fr.result);fr.readAsDataURL(b);});}
if('webkitSpeechRecognition'in window){stt=new webkitSpeechRecognition();stt.continuous=true;stt.interimResults=true;stt.lang='en-ZA';stt.onresult=e=>{let finalText='';for(let i=e.resultIndex;i<e.results.length;i++){const res=e.results[i];if(res.isFinal){finalText+=res[0].transcript+' ';}}if(finalText){$transcript.value+=finalText;triggerAutosave();}};stt.onend=()=>{if(sttOn){stt.start();}};}else{$btnToggleSTT.disabled=true;$btnToggleSTT.textContent='Live Transcribe not supported';}
$btnToggleSTT.addEventListener('click',()=>{if(!stt){return;}if(!sttOn){sttOn=true;stt.start();$sttStatus.style.display='inline-block';$btnToggleSTT.textContent='Disable Live Transcribe';}else{sttOn=false;try{stt.stop();}catch{}$sttStatus.style.display='none';$btnToggleSTT.textContent='Enable Live Transcribe';}});
$txtImport.addEventListener('change',async e=>{const f=e.target.files[0];if(!f)return;const text=await f.text();$transcript.value+= ( ($transcript.value?'\\n\\n':'') + text );triggerAutosave();e.target.value='';});

// ---------- Fees ----------
const $feeBody=document.getElementById('feeBody'),$feeSubtotal=document.getElementById('feeSubtotal'),$feeVAT=document.getElementById('feeVAT'),$feeTotal=document.getElementById('feeTotal'),$addFeeRow=document.getElementById('addFeeRow'),$clearFees=document.getElementById('clearFees');
function addFeeRow(row={desc:'',qty:1,rate:0}){feeRows.push(row);renderFees();}
function removeFeeRow(i){feeRows.splice(i,1);renderFees();}
function renderFees(){$feeBody.innerHTML='';feeRows.forEach((r,i)=>{const tr=document.createElement('tr');tr.innerHTML=`<td><input data-f='desc' data-i='${i}' value='${escapeHtml(r.desc)}' placeholder='Description'></td><td class='num'><input data-f='qty' data-i='${i}' value='${r.qty}' type='number' min='0' step='1'></td><td class='num'><input data-f='rate' data-i='${i}' value='${r.rate}' type='number' min='0' step='0.01'></td><td class='num'>${(r.qty*r.rate).toFixed(2)}</td><td class='no-print'><button class='btn small secondary' data-rm='${i}'>Remove</button></td>`;$feeBody.appendChild(tr);});updateFeeTotals();}
$feeBody.addEventListener('input',e=>{const i=e.target.getAttribute('data-i');const f=e.target.getAttribute('data-f');if(i!=null&&f){let v=e.target.value; if(f!=='desc'){v=parseFloat(v||0)};feeRows[+i][f]=v;renderFees();triggerAutosave();}});
$feeBody.addEventListener('click',e=>{const i=e.target.getAttribute('data-rm');if(i!=null){removeFeeRow(+i);triggerAutosave();}});
function updateFeeTotals(){const sub=feeRows.reduce((s,r)=>s+(Number(r.qty)||0)*(Number(r.rate)||0),0);const vat=sub*0.15;const tot=sub+vat;$feeSubtotal.textContent=sub.toFixed(2);$feeVAT.textContent=vat.toFixed(2);$feeTotal.textContent=tot.toFixed(2);}
$addFeeRow.addEventListener('click',()=>{addFeeRow();triggerAutosave();});
$clearFees.addEventListener('click',()=>{if(confirm('Clear all fee rows?')){feeRows=[];renderFees();triggerAutosave();}});

// ---------- Collect / Populate ----------
function collectData(){return{id:currentId,title:$claimRef.value.trim(),insured:$insured.value.trim(),assessor:$assessor.value.trim(),policyNo:$policyNo.value.trim(),insurer:$insurer.value.trim(),broker:$broker.value.trim(),riskAddress:$riskAddress.value.trim(),dateOfLoss:$dateOfLoss.value,dateOfAssessment:$dateOfAssessment.value,contactNumber:$contactNumber.value.trim(),email:$email.value.trim(),postalBlock:$postalBlock.value.trim(),circumstances:$circumstances.value,assessment:$assessment.value,conclusion:$conclusion.value,transcript:$transcript.value,photos:currentPhotos,clips:clips,fees:feeRows,updated:Date.now()};}
function populateData(d){$claimRef.value=d.title||'';$insured.value=d.insured||'';$assessor.value=d.assessor||'';$policyNo.value=d.policyNo||'';$insurer.value=d.insurer||'';$broker.value=d.broker||'';$riskAddress.value=d.riskAddress||'';$dateOfLoss.value=d.dateOfLoss||'';$dateOfAssessment.value=d.dateOfAssessment||'';$contactNumber.value=d.contactNumber||'';$email.value=d.email||'';$postalBlock.value=d.postalBlock||'';$circumstances.value=d.circumstances||'';$assessment.value=d.assessment||'';$conclusion.value=d.conclusion||'';$transcript.value=d.transcript||'';currentPhotos=d.photos||[];clips=d.clips||[];feeRows=d.fees||[];renderPhotos();renderClips();renderFees();}

// ---------- Save / Autosave ----------
function saveCurrent(){if(!currentId){currentId=newId();}const data=collectData();saveClaim(currentId,data);const idx=loadIndex();const ex=idx.find(x=>x.id===currentId);if(ex){ex.title=data.title;ex.insured=data.insured;ex.updated=data.updated;}else{idx.push({id:currentId,title:data.title,insured:data.insured,updated:data.updated});}saveIndex(idx);showSaved();return true;}
function showSaving(){$autosaveBadge.classList.add('saving');$autosaveBadge.classList.remove('saved');$autosaveText.textContent='Saving‚Ä¶';}
function showSaved(){$autosaveBadge.classList.remove('saving');$autosaveBadge.classList.add('saved');$autosaveText.textContent='Saved';setTimeout(()=>{$autosaveBadge.classList.remove('saved');$autosaveText.textContent='Idle';},1500);}
let autosaveTimer=null;
function triggerAutosave(){showSaving();clearTimeout(autosaveTimer);autosaveTimer=setTimeout(()=>{saveCurrent();},600);}
document.querySelectorAll('input, textarea').forEach(el=>{el.addEventListener('input',triggerAutosave);});

// ---------- Navigation & Events ----------
function newId(){return 'c'+Math.random().toString(36).slice(2,10)+Date.now().toString(36);}
$btnNew.addEventListener('click',()=>{currentId=newId();populateData({});switchToEditor();addFeeRow();});
$btnRefresh.addEventListener('click',renderDashboard);
$btnGoDashboard.addEventListener('click',switchToDashboard);
$btnPrint.addEventListener('click',()=>window.print());
document.addEventListener('click',e=>{const o=e.target.getAttribute&&e.target.getAttribute('data-open');const d=e.target.getAttribute&&e.target.getAttribute('data-del');if(o){const data=loadClaim(o);if(data){currentId=o;populateData(data);switchToEditor();}}if(d){if(confirm('Delete this claim?')){deleteClaim(d);renderDashboard();}}});
$btnSave.addEventListener('click',()=>{saveCurrent();});
$btnSaveExit.addEventListener('click',()=>{if(saveCurrent())switchToDashboard();});
$btnDelete.addEventListener('click',()=>{if(currentId&&confirm('Delete this claim?')){deleteClaim(currentId);switchToDashboard();}});

// ---------- Init ----------
renderDashboard();
</script>
</body>
</html>